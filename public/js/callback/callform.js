!function(){function doNotShowPopup(){sessionStorage.setItem("DoNotShowPopup",!0)}function canShowPopup(){return!sessionStorage.hasOwnProperty("DoNotShowPopup")}function setDataCallerAttribute(e){document.getElementById("cc-popup").dataset.caller=e}function cPopupClose(){document.getElementById("cc-popup").style.display="none",document.getElementById("cc-popup-shadow").style.display="none"}function cPopupOpen(){document.getElementById("cc-popup").style.display="block",document.getElementById("cc-popup-shadow").style.display="block";document.getElementById("cc-phone").value;document.getElementById("cc-phone").focus(),cSetEnd(document.getElementById("cc-phone"))}function cSetEnd(e){if(e.createTextRange){var t=e.createTextRange();t.moveStart("character",e.value.length),t.collapse(),t.select()}else{e.focus();var o=e.value.length;e.setSelectionRange(o,o)}}function cSendCall(){"undefined"!=eval("typeof yaCounter"+yandex_cn)&&eval("yaCounter"+yandex_cn).reachGoal(yandex_goal),document.getElementById("cc-error").innerHTML="";var phone=document.getElementById("cc-phone").value;if(!/^\+7[0-9]{10}$/.test(phone))return document.getElementById("cc-error").innerHTML="Неверный формат телефона: Телефон должен начинаться с +7 и содержать только цифры",!1;document.getElementById("cc-call").style.display="none",document.getElementById("cc-call1").style.display="inline-block",setTimeout(cTimerDown,1e3);var r=new XMLHttpRequest;r.open("GET",url+"?phone="+phone+"&key="+key,!0),r.onreadystatechange=function(){if(4==r.readyState&&200==r.status)try{var e=r.responseText;e=JSON.parse(e),1==e.error&&alert(e.message)}catch(t){console.log(t)}},r.send()}function cTimerDown(){document.getElementById("cc-timer").style.color=color;var e=parseInt(document.getElementById("cc-timer").innerHTML);document.getElementById("cc-timer").innerHTML=e-1,e>1&&setTimeout(cTimerDown,1e3)}function cSiteTime(){if(sessionStorage.hasOwnProperty("showBySiteTimer"))return!0;var e=null;return sessionStorage.hasOwnProperty("siteShowTimer")&&(e=parseInt(sessionStorage.getItem("siteShowTimer"))),clearTimeout(ssTimeVar),e==parseInt(site_time)?(sessionStorage.setItem("showBySiteTimer",1),doNotShowPopup(),setDataCallerAttribute("site_timer"),cPopupOpen(),!0):void(ssTimeVar=setTimeout(function(){e+=1,sessionStorage.setItem("siteShowTimer",e),cSiteTime()},1e3))}function noEventOpenCall(){clearTimeout(idleTimer),idleState=!1,idleTimer=setTimeout(function(){return idleState=!0,canShowPopup()?(setDataCallerAttribute("no_event"),doNotShowPopup(),void cPopupOpen()):!1},idleWait)}function pageCountShow(){if(sessionStorage.hasOwnProperty("page_count")){var e=JSON.parse(sessionStorage.getItem("page_count"));e.length+1==page_count&&(doNotShowPopup(),setDataCallerAttribute("page_count"),cPopupOpen()),-1==e.indexOf(location.pathname)&&e.push(location.pathname),sessionStorage.setItem("page_count",JSON.stringify(e))}else{var e=[];e.push(location.pathname),sessionStorage.setItem("page_count",JSON.stringify(e))}}function visitCountShow(){localStorage.hasOwnProperty("visit_count")?(sessionStorage.hasOwnProperty("visit_count")||localStorage.setItem("visit_count",parseInt(localStorage.getItem("visit_count"))+1),sessionStorage.hasOwnProperty("visit_count")||localStorage.getItem("visit_count")!=visit_count||(setDataCallerAttribute("visit_count"),doNotShowPopup(),cPopupOpen()),sessionStorage.hasOwnProperty("visit_count")||sessionStorage.setItem("visit_count",1)):(localStorage.setItem("visit_count",1),sessionStorage.setItem("visit_count",1))}var style="[style]",htmlInner="[html]",url="[url]",key="[key]",sop=parseInt("[sop]"),swe=parseInt("[swe]"),color="[color]",yandex_cn="[yandex_cn]",yandex_goal="[yandex_goal]",page_count=[page_count],client_count_show=[client_count_show],visit_count=[visit_count],site_time=[site_time],body=document.body,html=document.documentElement,height=Math.max(body.scrollHeight,body.offsetHeight,html.clientHeight,html.scrollHeight,html.offsetHeight);document.body.insertAdjacentHTML("beforeend",style+htmlInner);var ssTimeVar=null;if("undefined"!=typeof site_time){var ssTimeVar=null;cSiteTime()}var idleTimer=null,idleState=!1,idleWait=swe;document.addEventListener("mousemove",noEventOpenCall),document.addEventListener("keydown",noEventOpenCall),document.addEventListener("scroll",noEventOpenCall),document.addEventListener("touchstart",noEventOpenCall),"undefined"!=typeof page_count&&pageCountShow(),"undefined"!=typeof visit_count&&visitCountShow(),document.getElementById("cc-popup-shadow").style.height=height,document.getElementById("cc-phone-button").onclick=cPopupOpen,document.getElementById("cc-close").onclick=cPopupClose,document.getElementById("cc-call").onclick=cSendCall,window.setTimeout(function(){return canShowPopup()?(doNotShowPopup(),void cPopupOpen()):!1},sop)}();